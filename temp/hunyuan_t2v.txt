Warn: CUDA_VISIBLE_DEVICES is not set, using defalt value: 0, change at shell script or set env variable.
INFO 04-30 18:24:01 [__init__.py:239] Automatically detected platform cuda.
/mtc/yangrongjin/miniconda3/envs/lightx2v/lib/python3.11/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
2025-04-30 18:24:05.272 | INFO     | __main__:<module>:48 - args: Namespace(model_cls='hunyuan', task='t2v', model_path='/mtc/yongyang/models/x2v_models/hunyuan/lightx2v_format/t2v', config_json='/home/yangrongjin/lightx2v/configs/hunyuan_t2v.json', enable_cfg=False, prompt='A cat walks on the grass, realistic style.', negative_prompt='', image_path='', save_video_path='/home/yangrongjin/lightx2v/save_results/output_lightx2v_hy_t2v.mp4')
2025-04-30 18:24:05.439 | INFO     | __main__:<module>:52 - config:
{
    "do_mm_calib": false,
    "cpu_offload": false,
    "parallel_attn_type": null,
    "parallel_vae": false,
    "max_area": false,
    "vae_stride": [
        4,
        8,
        8
    ],
    "patch_size": [
        1,
        2,
        2
    ],
    "feature_caching": "NoCaching",
    "teacache_thresh": 0.26,
    "use_ret_steps": false,
    "use_bfloat16": true,
    "lora_path": null,
    "strength_model": 1.0,
    "mm_config": {
        "mm_type": "W-int8-channel-sym-A-int8-channel-sym-dynamic-Vllm",
        "weight_auto_quant": true
    },
    "model_cls": "hunyuan",
    "task": "t2v",
    "model_path": "/mtc/yongyang/models/x2v_models/hunyuan/lightx2v_format/t2v",
    "config_json": "/home/yangrongjin/lightx2v/configs/hunyuan_t2v.json",
    "enable_cfg": false,
    "prompt": "A cat walks on the grass, realistic style.",
    "negative_prompt": "",
    "image_path": "",
    "save_video_path": "/home/yangrongjin/lightx2v/save_results/output_lightx2v_hy_t2v.mp4",
    "infer_steps": 20,
    "target_video_length": 33,
    "target_height": 720,
    "target_width": 1280,
    "attention_type": "flash_attn3",
    "seed": 42
}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.57s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.65s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:05<00:01,  1.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:05<00:00,  1.38s/it]
2025-04-30 18:25:22.303 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Load models cost 76.859276 seconds
2025-04-30 18:25:22.958 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Run Text Encoder cost 0.652779 seconds
2025-04-30 18:25:23.229 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 1 / 20
2025-04-30 18:25:23.230 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000047 seconds
2025-04-30 18:25:25.909 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.679179 seconds
2025-04-30 18:25:25.909 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000148 seconds
2025-04-30 18:25:25.909 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 2 / 20
2025-04-30 18:25:25.909 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000027 seconds
2025-04-30 18:25:27.971 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.061814 seconds
2025-04-30 18:25:27.972 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000249 seconds
2025-04-30 18:25:27.972 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 3 / 20
2025-04-30 18:25:27.972 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000031 seconds
2025-04-30 18:25:30.035 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.063221 seconds
2025-04-30 18:25:30.035 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000147 seconds
2025-04-30 18:25:30.035 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 4 / 20
2025-04-30 18:25:30.035 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000027 seconds
2025-04-30 18:25:32.100 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.064141 seconds
2025-04-30 18:25:32.100 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000116 seconds
2025-04-30 18:25:32.100 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 5 / 20
2025-04-30 18:25:32.100 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000025 seconds
2025-04-30 18:25:34.168 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.067842 seconds
2025-04-30 18:25:34.168 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000103 seconds
2025-04-30 18:25:34.168 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 6 / 20
2025-04-30 18:25:34.168 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-04-30 18:25:36.234 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.066036 seconds
2025-04-30 18:25:36.234 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000125 seconds
2025-04-30 18:25:36.235 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 7 / 20
2025-04-30 18:25:36.235 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-04-30 18:25:38.301 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.066300 seconds
2025-04-30 18:25:38.301 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000124 seconds
2025-04-30 18:25:38.301 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 8 / 20
2025-04-30 18:25:38.301 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000026 seconds
2025-04-30 18:25:40.373 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.071601 seconds
2025-04-30 18:25:40.373 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000135 seconds
2025-04-30 18:25:40.373 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 9 / 20
2025-04-30 18:25:40.373 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000026 seconds
2025-04-30 18:25:42.440 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.067138 seconds
2025-04-30 18:25:42.441 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000133 seconds
2025-04-30 18:25:42.441 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 10 / 20
2025-04-30 18:25:42.441 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000025 seconds
2025-04-30 18:25:44.508 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.067487 seconds
2025-04-30 18:25:44.509 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000137 seconds
2025-04-30 18:25:44.509 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 11 / 20
2025-04-30 18:25:44.509 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000025 seconds
2025-04-30 18:25:46.577 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.068369 seconds
2025-04-30 18:25:46.577 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000123 seconds
2025-04-30 18:25:46.577 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 12 / 20
2025-04-30 18:25:46.577 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000024 seconds
2025-04-30 18:25:48.651 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.073625 seconds
2025-04-30 18:25:48.651 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000110 seconds
2025-04-30 18:25:48.651 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 13 / 20
2025-04-30 18:25:48.651 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000025 seconds
2025-04-30 18:25:50.721 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.069919 seconds
2025-04-30 18:25:50.722 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000098 seconds
2025-04-30 18:25:50.722 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 14 / 20
2025-04-30 18:25:50.722 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-04-30 18:25:52.793 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.071680 seconds
2025-04-30 18:25:52.794 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000124 seconds
2025-04-30 18:25:52.794 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 15 / 20
2025-04-30 18:25:52.794 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000024 seconds
2025-04-30 18:25:54.866 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.071878 seconds
2025-04-30 18:25:54.866 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000103 seconds
2025-04-30 18:25:54.866 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 16 / 20
2025-04-30 18:25:54.866 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-04-30 18:25:56.936 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.070347 seconds
2025-04-30 18:25:56.937 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000098 seconds
2025-04-30 18:25:56.937 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 17 / 20
2025-04-30 18:25:56.937 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-04-30 18:25:59.008 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.071552 seconds
2025-04-30 18:25:59.008 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000109 seconds
2025-04-30 18:25:59.009 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 18 / 20
2025-04-30 18:25:59.009 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-04-30 18:26:01.079 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.070498 seconds
2025-04-30 18:26:01.079 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000106 seconds
2025-04-30 18:26:01.079 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 19 / 20
2025-04-30 18:26:01.079 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-04-30 18:26:03.156 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.076276 seconds
2025-04-30 18:26:03.156 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000120 seconds
2025-04-30 18:26:03.156 | INFO     | lightx2v.models.runners.default_runner:run:36 - ==> step_index: 20 / 20
2025-04-30 18:26:03.156 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-04-30 18:26:05.227 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.070946 seconds
2025-04-30 18:26:05.227 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000097 seconds
2025-04-30 18:26:10.380 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Run VAE cost 5.152845 seconds
2025-04-30 18:26:11.191 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Save video cost 0.810260 seconds
2025-04-30 18:26:11.206 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Total Cost cost 125.768983 seconds
