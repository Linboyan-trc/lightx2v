INFO 06-05 16:41:18 [__init__.py:239] Automatically detected platform cuda.
/mtc/yangrongjin/miniconda3/envs/lightx2v/lib/python3.11/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
2025-06-05 16:41:22.217 | INFO     | __main__:<module>:49 - args: Namespace(model_cls='hunyuan', task='i2v', model_path='/mtc/yongyang/models/x2v_models/hunyuan/lightx2v_format/i2v', config_json='/home/yangrongjin/lightx2v/configs/caching/hunyuan_i2v_TaylorSeer.json', prompt_enhancer=None, prompt='An Asian man with short hair in black tactical uniform and white clothes waves a firework stick.', negative_prompt='', image_path='/home/yangrongjin/lightx2v/assets/inputs/imgs/img_1.jpg', save_video_path='/home/yangrongjin/lightx2v/save_results/output_lightx2v_hy_i2v_taylor.mp4')
2025-06-05 16:41:22.474 | INFO     | __main__:<module>:53 - config:
{
    "do_mm_calib": false,
    "cpu_offload": false,
    "parallel_attn_type": null,
    "parallel_vae": false,
    "max_area": false,
    "vae_stride": [
        4,
        8,
        8
    ],
    "patch_size": [
        1,
        2,
        2
    ],
    "feature_caching": "TaylorSeer",
    "teacache_thresh": 0.26,
    "use_ret_steps": false,
    "use_bfloat16": true,
    "lora_path": null,
    "strength_model": 1.0,
    "mm_config": {
        "mm_type": "W-int8-channel-sym-A-int8-channel-sym-dynamic-Vllm",
        "weight_auto_quant": true
    },
    "use_prompt_enhancer": false,
    "model_cls": "hunyuan",
    "task": "i2v",
    "model_path": "/mtc/yongyang/models/x2v_models/hunyuan/lightx2v_format/i2v",
    "config_json": "/home/yangrongjin/lightx2v/configs/caching/hunyuan_i2v_TaylorSeer.json",
    "prompt_enhancer": null,
    "prompt": "An Asian man with short hair in black tactical uniform and white clothes waves a firework stick.",
    "negative_prompt": "",
    "image_path": "/home/yangrongjin/lightx2v/assets/inputs/imgs/img_1.jpg",
    "save_video_path": "/home/yangrongjin/lightx2v/save_results/output_lightx2v_hy_i2v_taylor.mp4",
    "infer_steps": 20,
    "target_video_length": 33,
    "i2v_resolution": "720p",
    "attention_type": "flash_attn3",
    "seed": 0
}
SparseAttentionMeansim not found, please install sparge first
sageattn not found, please install sageattention first
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:06,  2.13s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:05<00:01,  1.89s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.40s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
2025-06-05 16:42:46.389 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Load models cost 83.907645 seconds
2025-06-05 16:42:47.345 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Run Img Encoder cost 0.954605 seconds
Expanding inputs for image tokens in LLaVa should be done in processing. Please add `patch_size` and `vision_feature_select_strategy` to the model's processing config or set directly with `processor.patch_size = {{patch_size}}` and processor.vision_feature_select_strategy = {{vision_feature_select_strategy}}`. Using processors without these attributes in the config is deprecated and will throw an error in v4.47.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
2025-06-05 16:42:47.670 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Run Text Encoder cost 0.325019 seconds
2025-06-05 16:42:47.937 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 1 / 20
2025-06-05 16:42:47.937 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000054 seconds
2025-06-05 16:42:50.203 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.265450 seconds
2025-06-05 16:42:50.203 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000297 seconds
2025-06-05 16:42:50.203 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 2 / 20
2025-06-05 16:42:50.203 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000025 seconds
2025-06-05 16:42:50.294 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.090777 seconds
2025-06-05 16:42:50.294 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000141 seconds
2025-06-05 16:42:50.294 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 3 / 20
2025-06-05 16:42:50.294 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:50.383 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.088850 seconds
2025-06-05 16:42:50.384 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000175 seconds
2025-06-05 16:42:50.384 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 4 / 20
2025-06-05 16:42:50.384 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000031 seconds
2025-06-05 16:42:50.473 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.089020 seconds
2025-06-05 16:42:50.473 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000141 seconds
2025-06-05 16:42:50.473 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 5 / 20
2025-06-05 16:42:50.473 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:52.584 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.111173 seconds
2025-06-05 16:42:52.585 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000187 seconds
2025-06-05 16:42:52.585 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 6 / 20
2025-06-05 16:42:52.585 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000024 seconds
2025-06-05 16:42:52.706 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.120749 seconds
2025-06-05 16:42:52.706 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000141 seconds
2025-06-05 16:42:52.706 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 7 / 20
2025-06-05 16:42:52.706 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:52.825 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119416 seconds
2025-06-05 16:42:52.826 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000156 seconds
2025-06-05 16:42:52.826 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 8 / 20
2025-06-05 16:42:52.826 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000023 seconds
2025-06-05 16:42:52.945 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119475 seconds
2025-06-05 16:42:52.946 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000141 seconds
2025-06-05 16:42:52.946 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 9 / 20
2025-06-05 16:42:52.946 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:55.059 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.113585 seconds
2025-06-05 16:42:55.060 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000198 seconds
2025-06-05 16:42:55.060 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 10 / 20
2025-06-05 16:42:55.060 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000027 seconds
2025-06-05 16:42:55.180 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.120329 seconds
2025-06-05 16:42:55.180 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000145 seconds
2025-06-05 16:42:55.180 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 11 / 20
2025-06-05 16:42:55.180 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:55.300 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119390 seconds
2025-06-05 16:42:55.300 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000143 seconds
2025-06-05 16:42:55.300 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 12 / 20
2025-06-05 16:42:55.300 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:55.420 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119346 seconds
2025-06-05 16:42:55.420 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000144 seconds
2025-06-05 16:42:55.420 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 13 / 20
2025-06-05 16:42:55.420 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000022 seconds
2025-06-05 16:42:57.532 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.111632 seconds
2025-06-05 16:42:57.532 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000195 seconds
2025-06-05 16:42:57.532 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 14 / 20
2025-06-05 16:42:57.532 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000024 seconds
2025-06-05 16:42:57.652 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.120321 seconds
2025-06-05 16:42:57.653 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000116 seconds
2025-06-05 16:42:57.653 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 15 / 20
2025-06-05 16:42:57.653 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000021 seconds
2025-06-05 16:42:57.772 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119473 seconds
2025-06-05 16:42:57.772 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000112 seconds
2025-06-05 16:42:57.772 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 16 / 20
2025-06-05 16:42:57.772 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000020 seconds
2025-06-05 16:42:57.892 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119529 seconds
2025-06-05 16:42:57.892 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000113 seconds
2025-06-05 16:42:57.892 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 17 / 20
2025-06-05 16:42:57.892 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000021 seconds
2025-06-05 16:43:00.000 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 2.107550 seconds
2025-06-05 16:43:00.000 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000140 seconds
2025-06-05 16:43:00.000 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 18 / 20
2025-06-05 16:43:00.000 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000029 seconds
2025-06-05 16:43:00.121 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.120770 seconds
2025-06-05 16:43:00.121 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000118 seconds
2025-06-05 16:43:00.121 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 19 / 20
2025-06-05 16:43:00.122 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000021 seconds
2025-06-05 16:43:00.241 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119585 seconds
2025-06-05 16:43:00.241 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000119 seconds
2025-06-05 16:43:00.241 | INFO     | lightx2v.models.runners.default_runner:run:52 - ==> step_index: 20 / 20
2025-06-05 16:43:00.241 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_pre cost 0.000021 seconds
2025-06-05 16:43:00.361 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] infer cost 0.119563 seconds
2025-06-05 16:43:00.361 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] step_post cost 0.000114 seconds
2025-06-05 16:43:00.362 | INFO     | lightx2v.utils.memory_profiler:wrapper:23 - Function 'DefaultRunner.run' Peak Memory: 71.54 GB
2025-06-05 16:43:05.543 | INFO     | lightx2v.utils.memory_profiler:wrapper:23 - Function 'DefaultRunner.run_vae' Peak Memory: 73.57 GB
2025-06-05 16:43:05.544 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Run VAE cost 5.176661 seconds
2025-06-05 16:43:06.286 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Save video cost 0.742323 seconds
2025-06-05 16:43:06.498 | INFO     | lightx2v.utils.profiler:__exit__:20 - [Profile] Total Cost cost 104.025436 seconds
